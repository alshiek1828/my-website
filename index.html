<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>موقعي الخرافي</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to bottom, #1c1c1c, #2b2b2b);
      color: #fff;
      text-align: center;
      padding: 50px;
    }

    h1 {
      font-size: 3em;
      margin-bottom: 10px;
      color: #00ffe7;
      text-shadow: 0 0 10px #00ffe7;
    }

    p {
      font-size: 1.2em;
      color: #ccc;
      margin-bottom: 40px;
    }

    button {
      background-color: #ff0066;
      color: white;
      border: none;
      border-radius: 30px;
      padding: 15px 30px;
      font-size: 1.2em;
      cursor: pointer;
      box-shadow: 0 0 20px #ff0066;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    button:hover {
      background-color: #ff3388;
      transform: scale(1.05);
    }

    a {
      display: inline-block;
      margin: 20px;
      padding: 10px 20px;
      background-color: #00aaff;
      color: white;
      text-decoration: none;
      border-radius: 20px;
      box-shadow: 0 0 10px #00aaff;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    a:hover {
      background-color: #33bbff;
      transform: scale(1.05);
    }

    footer {
      margin-top: 60px;
      font-size: 0.9em;
      color: #999;
    }

    /* Chat Section */
    #chatContainer {
      width: 80%;
      margin: 0 auto;
      background-color: #333;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
      text-align: left;
      display: none;
    }

    #nameContainer {
      width: 80%;
      margin: 0 auto;
      background-color: #333;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
      text-align: center;
    }

    .messagesContainer {
      max-height: 400px;
      overflow-y: auto;
      margin-bottom: 20px;
    }

    .message {
      background-color: #444;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      color: white;
    }

    input[type="text"], textarea {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: none;
      border-radius: 5px;
      background-color: #555;
      color: white;
    }

    input[type="file"] {
      margin: 10px 0;
    }

    button {
      background-color: #ff0066;
      color: white;
      border: none;
      border-radius: 10px;
      padding: 10px 20px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #ff3388;
    }
  </style>
</head>
<body>

  <h1>Welcome to My Website!</h1>
  <p>Created by alshiek</p>

  <button onclick="toggleAudio()">تشغيل / إيقاف الأغنية</button>

  <audio id="myAudio">
    <source src="song.mp3" type="audio/mpeg">
    متصفحك لا يدعم تشغيل الصوت.
  </audio>

  <br><br>
  <a href="https://t.me/HNR55" target="_blank">راسلني على تليجرام</a>
  <a href="https://www.amazon.com/T3-develper-Car-Fury/dp/B0DWY3QHWF" target="_blank">شاهد لعبتي Car Fury</a>

  <footer>
    &copy; 2025 - Made with madness by ツ《👑》Ͳ３《شــيـخ》
  </footer>

  <!-- Name Input Section -->
  <div id="nameContainer">
    <h2>يرجى إدخال اسمك</h2>
    <input type="text" id="usernameInput" placeholder="أدخل اسمك" required>
    <button onclick="saveUsername()">تأكيد</button>
  </div>

  <!-- Chat Section -->
  <div id="chatContainer">
    <h2>الدردشة المباشرة</h2>
    <div id="messagesContainer" class="messagesContainer"></div>
    <input type="text" id="messageInput" placeholder="اكتب رسالتك..." required>
    <input type="file" id="imageInput" accept="image/*">
    <button onclick="sendMessage()">إرسال</button>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js"></script>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBwHD40ddsgj7dbfZf7-y9TivXVubnMT8c",
      authDomain: "application-t3.firebaseapp.com",
      databaseURL: "https://application-t3-default-rtdb.firebaseio.com",
      projectId: "application-t3",
      storageBucket: "application-t3.appspot.com",
      messagingSenderId: "594354801953",
      appId: "1:594354801953:android:4e294f4151129a7ed8c260"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const storage = firebase.storage();

    let username = '';

    // Check if user has a saved username
    function checkUsername() {
      const savedUsername = localStorage.getItem('username');
      if (savedUsername) {
        username = savedUsername;
        showChat();
      } else {
        showNameInput();
      }
    }

    // Show the chat interface
    function showChat() {
      document.getElementById('chatContainer').style.display = 'block';
      document.getElementById('nameContainer').style.display = 'none';
      getMessages();
    }

    // Show the name input interface
    function showNameInput() {
      document.getElementById('nameContainer').style.display = 'block';
      document.getElementById('chatContainer').style.display = 'none';
    }

    // Save username and display the chat
    function saveUsername() {
      username = document.getElementById('usernameInput').value;
      if (username) {
        // Save username in Firebase under 'website_chat' node
        db.ref('website_chat/' + username).set({
          name: username
        }).then(() => {
          localStorage.setItem('username', username);
          showChat();
        }).catch((error) => {
          alert('حدث خطأ أثناء حفظ الاسم: ' + error.message);
        });
      } else {
        alert('يرجى إدخال اسمك');
      }
    }

    // Send a message
    function sendMessage() {
      const messageInput = document.getElementById('messageInput');
      const imageInput = document.getElementById('imageInput');
      
      let message = messageInput.value;
      let imageFile = imageInput.files[0];

      if (imageFile) {
        const storageRef = storage.ref();
        const fileRef = storageRef.child('images/' + imageFile.name);
        fileRef.put(imageFile).then((snapshot) => {
          snapshot.ref.getDownloadURL().then((downloadURL) => {
            saveMessage(message, downloadURL);
          });
        });
      } else {
        saveMessage(message, null);
      }

      messageInput.value = '';
      imageInput.value = '';
    }

    // Save message to Firebase
    function saveMessage(message, imageUrl) {
      const newMessageRef = db.ref('messages').push();
      newMessageRef.set({
        username: username,
        message: message,
        imageUrl: imageUrl,
        timestamp: Date.now()
      });
    }

    // Get messages from Firebase
    function getMessages() {
      const messagesContainer = document.getElementById('messagesContainer');
      db.ref('messages').on('child_added', (snapshot) => {
        const data = snapshot.val();
        const messageElement = document.createElement('div');
        messageElement.classList.add('message');
        messageElement.innerHTML = `
          <p><strong>${data.username}</strong>: ${data.message}</p>
          ${data.imageUrl ? `<img src="${data.imageUrl}" alt="image" class="messageImage">` : ''}
        `;
        messagesContainer.appendChild(messageElement);
      });
    }

    // Run check on page load
    window.onload = function() {
      checkUsername();
    };

    // Audio toggle function
    const audio = document.getElementById("myAudio");
    function toggleAudio() {
      if (audio.paused) {
        audio.play();
      } else {
        audio.pause();
      }
    }
  </script>

</body>
</html>
