<!DOCTYPE html>
<html lang="ar">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ ÙˆØ§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</title>
    <style>
      /* Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ù†Ù…Ø§Ø· ÙˆØ§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
      *, *::before, *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(to bottom, #1c1c1c, #2b2b2b);
        color: #fff;
        direction: rtl;
        line-height: 1.5;
      }
      header {
        text-align: center;
        padding: 20px;
      }
      header h1 {
        font-size: 2.5em;
        color: #00ffe7;
        text-shadow: 0 0 10px #00ffe7;
      }
      nav {
        background: #333;
        text-align: center;
        padding: 10px 0;
      }
      nav button {
        background: #ff0066;
        color: #fff;
        border: none;
        padding: 10px 20px;
        margin: 5px;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s;
      }
      nav button:hover,
      nav button.active {
        background: #ff3388;
        transform: scale(1.05);
      }
      /* Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØµÙØ­Ø© */
      .section {
        display: none;
        padding: 20px;
      }
      .active {
        display: block;
      }
      /* Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† */
      #admin-panel {
        display: none;
        position: fixed;
        top: 20%;
        left: 50%;
        transform: translateX(-50%);
        background: #555;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 15px #000;
        z-index: 1000;
        width: 90%;
        max-width: 400px;
      }
      #admin-panel h2 {
        text-align: center;
        margin-bottom: 15px;
      }
      #admin-panel button {
        width: 100%;
        margin: 5px 0;
      }
      /* Ø¬Ø¯ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† */
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }
      th, td {
        border: 1px solid #666;
        padding: 10px;
        text-align: center;
      }
      th {
        background: #222;
      }
      /* Ù†Ù…Ø· Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
      #emoji-container {
        text-align: center;
        margin: 20px 0;
      }
      .emoji-btn {
        font-size: 2em;
        margin: 10px;
        padding: 10px;
        border: none;
        background: #777;
        color: #fff;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        cursor: pointer;
        transition: transform 0.2s;
      }
      .emoji-btn:hover {
        transform: scale(1.1);
      }
      #countdown {
        font-size: 2em;
        margin: 15px;
        text-align: center;
      }
      /* Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ù…Ø¶Ù…Ù†Ø© */
      .key-layout {
        display: inline-block;
        margin-top: 15px;
        text-align: center;
      }
      .key-row {
        margin: 5px 0;
      }
      .key-button {
        background: #444;
        border: 1px solid #666;
        margin: 3px;
        padding: 8px 12px;
        border-radius: 5px;
        cursor: pointer;
      }
      footer {
        text-align: center;
        padding: 10px;
        margin-top: 20px;
        font-size: 0.9em;
      }
    </style>
  </head>
  <body>
    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (ÙŠÙØ¹Ø±Ø¶ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¯ÙˆÙ† Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„) -->
    <div id="main-content" class="section active">
      <header>
        <h1>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ ÙˆØ§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h1>
      </header>
      <nav>
        <button onclick="showSection('game')">Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        <button onclick="showSection('leaderboard')">Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</button>
        <button onclick="openAdminPanel()">Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</button>
        <button onclick="openSettings()">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
      </nav>
      <!-- Ù‚Ø³Ù… Ø§Ù„Ù„Ø¹Ø¨Ø© -->
      <div id="game" class="section active">
        <h2>Ù„Ø¹Ø¨Ø© ÙƒØ±Ø© Ø§Ù„ÙˆØ¬Ù‡ Ø§Ù„Ù…Ø¨ØªØ³Ù… - Ø§Ù„Ù…Ø±Ø­Ù„Ø© <span id="current-level">1</span></h2>
        <p id="game-status">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ" Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø­Ù„Ø©.</p>
        <button class="btn" id="start-game-btn" onclick="startChallenge()">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ</button>
        <div id="countdown"></div>
        <div id="emoji-container"></div>
      </div>
      <!-- Ù‚Ø³Ù… Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† -->
      <div id="leaderboard" class="section">
        <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</h2>
        <table>
          <thead>
            <tr>
              <th>Ø§Ù„ØªØ±ØªÙŠØ¨</th>
              <th>Ø§Ù„Ø§Ø³Ù…</th>
              <th>Ø§Ù„Ù†Ù‚Ø§Ø·</th>
              <th>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</th>
            </tr>
          </thead>
          <tbody id="leaderboard-body">
            <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
          </tbody>
        </table>
      </div>
    </div>
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† (Ù…Ø­Ù…ÙŠØ© Ø¨Ø§Ù„Ø±Ù…Ø² "0000") -->
    <div id="admin-panel">
      <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</h2>
      <div id="admin-options">
        <button class="btn" onclick="adminAction('ban')">Ø­Ø¸Ø± Ù…Ø³ØªØ®Ø¯Ù…</button>
        <button class="btn" onclick="adminAction('unban')">ÙÙƒ Ø­Ø¸Ø± Ù…Ø³ØªØ®Ø¯Ù…</button>
        <button class="btn" onclick="adminAction('stats')">Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        <button class="btn" onclick="adminAction('reset')">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù‚Ø§Ø·</button>
      </div>
      <button class="btn" onclick="closeAdminPanel()">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø£Ø¯Ù…Ù†</button>
    </div>
    <footer>
      &copy; 2025 - Made with madness by ãƒ„ ã€ŠğŸ‘‘ã€‹Í²ï¼“ ã€ŠØ´iek899ã€‹
    </footer>
    <!-- ØªØ¶Ù…ÙŠÙ† Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
    <script>
      // Ø¥Ø¹Ø¯Ø§Ø¯ Firebase - ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ØµØ­ÙŠØ­Ø©
      const firebaseConfig = {
        apiKey: "AIzaSyDZt1RSz5d9wyn-C5S3kF8XVYjEldtSZss",
        authDomain: "gmae-fae90.firebaseapp.com",
        databaseURL: "https://gmae-fae90-default-rtdb.firebaseio.com",
        projectId: "gmae-fae90",
        storageBucket: "gmae-fae90.appspot.com",
        messagingSenderId: "768482186329",
        appId: "1:768482186329:web:18937587e530f8674e0d48",
        measurementId: "G-V4ZLJ4BJGD"
      };
      firebase.initializeApp(firebaseConfig);
      const db = firebase.database();
  
      // ØªÙˆÙ„ÙŠØ¯ UUID Ù…Ø¨Ø³Ø· ÙˆØªØ®Ø²ÙŠÙ†Ù‡ ÙÙŠ localStorage Ù„Ù„Ø²Ø§Ø¦Ø±
      function generateId() {
        return "xxxx-xxxx-xxxx".replace(/x/g, () =>
          Math.floor(Math.random() * 16).toString(16)
        );
      }
      let visitorId = localStorage.getItem("visitorId");
      if (!visitorId) {
        visitorId = generateId();
        localStorage.setItem("visitorId", visitorId);
      }
    </script>
    <!-- Ø³ÙƒØ±Ø¨Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <script>
      // ØªØ¹Ø±ÙŠÙ Ù…Ø³ØªØ®Ø¯Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠ (ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ±Ù‡ ÙƒÙ…Ø§ ØªØ±ÙŠØ¯)
      let currentUser = {
        name: "Ø´ÙŠØ® Ø§Ù„Ø£ÙƒÙˆØ§Ø¯",
        username: "ShykCoder",
        userId: "default_" + Math.random().toString(36).substr(2, 5),
        score: 0,
        level: 1
      };
      // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ ÙÙŠ localStorage
      localStorage.setItem("currentUser", JSON.stringify(currentUser));
      document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("current-level").textContent = currentUser.level;
        checkBanStatus();
      });
  
      // Ø¯Ø§Ù„Ø© ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
      function showSection(sectionId) {
        document.querySelectorAll("#main-content > .section")
          .forEach((s) => s.classList.remove("active"));
        document.getElementById(sectionId).classList.add("active");
        if (sectionId === "leaderboard") renderLeaderboard();
      }
  
      // ----------------- Ù…Ù†Ø·Ù‚ Ø§Ù„Ù„Ø¹Ø¨Ø© -----------------
      let challengeTimer;
      let challengeTimeLeft;
      const correctEmoji = "â˜ºï¸";
      const wrongEmojis = ["â˜¹ï¸", "ğŸ˜¢", "ğŸ˜", "ğŸ˜Ÿ", "ğŸ™"];
  
      function startChallenge() {
        checkBanStatus().then((banData) => {
          if (banData && banData.banUntil && Date.now() < banData.banUntil) {
            alert(
              "Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù„Ø£Ù†Ùƒ Ù…Ø­Ø¸ÙˆØ±. Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„Ø­Ø¸Ø±: " +
              Math.ceil((banData.banUntil - Date.now()) / 60000) +
              " Ø¯Ù‚ÙŠÙ‚Ø©."
            );
            return;
          }
          const level = currentUser.level || 1;
          // Ø¶Ø¨Ø· Ø§Ù„ÙˆÙ‚Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰: Ù„Ù„Ù…Ø³ØªÙˆÙ‰ 1 5 Ø«ÙˆØ§Ù†ÙØŒ ÙˆØ¥Ù„Ø§ 3 Ø«ÙˆØ§Ù†Ù
          challengeTimeLeft = level === 1 ? 5 : 3;
          document.getElementById("game-status").textContent =
            "Ø§Ù„Ù…Ø±Ø­Ù„Ø© " + level + ": Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø±Ù…Ø² Ø§Ù„ØªØ¹Ø¨ÙŠØ±ÙŠ Ø§Ù„Ù…Ø¨ØªØ³Ù…!";
          const emojiContainer = document.getElementById("emoji-container");
          emojiContainer.innerHTML = "";
          // Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù…Ø¹ ÙƒÙ„ Ù…Ø³ØªÙˆÙ‰
          const totalButtons = 8 + (level - 1) * 2;
          const correctIndex = Math.floor(Math.random() * totalButtons);
          for (let i = 0; i < totalButtons; i++) {
            const btn = document.createElement("button");
            btn.className = "emoji-btn";
            btn.textContent =
              i === correctIndex
                ? correctEmoji
                : wrongEmojis[Math.floor(Math.random() * wrongEmojis.length)];
            btn.onclick = () => checkAnswer(btn.textContent);
            emojiContainer.appendChild(btn);
          }
          document.getElementById("countdown").textContent = challengeTimeLeft;
          challengeTimer = setInterval(() => {
            challengeTimeLeft--;
            document.getElementById("countdown").textContent = challengeTimeLeft;
            if (challengeTimeLeft <= 0) {
              clearInterval(challengeTimer);
              document.getElementById("game-status").textContent =
                "Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.";
              updateScore(false);
            }
          }, 1000);
        });
      }
  
      function checkAnswer(selected) {
        clearInterval(challengeTimer);
        if (selected === correctEmoji) {
          document.getElementById("game-status").textContent =
            "Ø£Ø­Ø³Ù†Øª! Ø¥Ø¬Ø§Ø¨ØªÙƒ ØµØ­ÙŠØ­Ø©.";
          currentUser.score++;
          // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ 1 Ù†Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2
          if (currentUser.level === 1) {
            currentUser.level = 2;
            alert("ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ù„Ù‚Ø¯ Ø§Ù†ØªÙ‚Ù„Øª Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©.");
          }
          updateScore(true);
        } else {
          document.getElementById("game-status").textContent =
            "Ù„Ù„Ø£Ø³ÙØŒ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ø®Ø§Ø·Ø¦Ø©.";
          updateScore(false);
        }
        document.getElementById("countdown").textContent = "";
        document.getElementById("emoji-container").innerHTML = "";
        document.getElementById("current-level").textContent =
          currentUser.level || 1;
      }
  
      function updateScore(correct) {
        db.ref("users/" + currentUser.userId + "/score").set(currentUser.score);
        db.ref("users/" + currentUser.userId + "/level").set(currentUser.level);
        db.ref("leaderboard/" + currentUser.userId).set({
          name: currentUser.name,
          score: currentUser.score,
          level: currentUser.level,
        });
      }
  
      // ----------------- Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† -----------------
      function renderLeaderboard() {
        const lbBody = document.getElementById("leaderboard-body");
        lbBody.innerHTML = "";
        db.ref("leaderboard")
          .orderByChild("score")
          .once("value", (snapshot) => {
            let leaderboard = [];
            snapshot.forEach((child) => {
              leaderboard.push(child.val());
            });
            leaderboard.sort((a, b) => b.score - a.score);
            leaderboard.forEach((entry, index) => {
              const row = document.createElement("tr");
              row.innerHTML = `<td>${index + 1}</td>
                               <td>${entry.name}</td>
                               <td>${entry.score}</td>
                               <td>${entry.level || 1}</td>`;
              lbBody.appendChild(row);
            });
          });
      }
  
      // ----------------- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¸Ø± -----------------
      function checkBanStatus() {
        if (!currentUser) return Promise.resolve(null);
        return db.ref("bans/" + currentUser.userId).get().then((snapshot) => {
          return snapshot.exists() ? snapshot.val() : null;
        });
      }
  
      // ----------------- Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† -----------------
      const ADMIN_CODE = "0000"; // Ø±Ù…Ø² Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†
      function openAdminPanel() {
        const code = prompt("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†:");
        if (code === ADMIN_CODE) {
          document.getElementById("admin-panel").style.display = "block";
        } else {
          alert("Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­.");
        }
      }
  
      function closeAdminPanel() {
        document.getElementById("admin-panel").style.display = "none";
      }
  
      function adminAction(action) {
        switch (action) {
          case "ban":
            const banUserId = prompt("Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø­Ø¸Ø±Ù‡:");
            const banMinutes = parseInt(prompt("Ø£Ø¯Ø®Ù„ Ù…Ø¯Ø© Ø§Ù„Ø­Ø¸Ø± Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚:"), 10);
            if (banUserId && banMinutes) {
              const banUntil = Date.now() + banMinutes * 60000;
              db.ref("bans/" + banUserId).set({ banUntil });
              alert("ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… " + banUserId + " Ù„Ù…Ø¯Ø© " + banMinutes + " Ø¯Ù‚ÙŠÙ‚Ø©.");
            }
            break;
          case "unban":
            const unbanUserId = prompt("Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ÙÙƒ Ø§Ù„Ø­Ø¸Ø±:");
            if (unbanUserId) {
              db.ref("bans/" + unbanUserId).remove();
              alert("ØªÙ… ÙÙƒ Ø§Ù„Ø­Ø¸Ø± Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… " + unbanUserId);
            }
            break;
          case "stats":
            db.ref("users").once("value").then((snapshot) => {
              alert("Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†: " + snapshot.numChildren());
            });
            break;
          case "reset":
            if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù‚Ø§Ø·ØŸ")) {
              db.ref("leaderboard").remove();
              db.ref("users").once("value", (snapshot) => {
                snapshot.forEach((child) => {
                  db.ref("users/" + child.key + "/score").set(0);
                });
              });
              alert("ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù‚Ø§Ø·.");
            }
            break;
          default:
            alert("Ø£Ù…Ø± ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ");
        }
      }
  
      // ----------------- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -----------------
      function openSettings() {
        let newName = prompt("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯:", currentUser.name);
        if (newName && newName !== currentUser.name) {
          currentUser.name = newName;
          localStorage.setItem("currentUser", JSON.stringify(currentUser));
          db.ref("users/" + currentUser.userId + "/name").set(newName);
          alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù…!");
        }
        if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ù†Ø³Ø® Ù…Ø¹Ø±ÙÙƒØŸ")) {
          navigator.clipboard.writeText(currentUser.userId).then(() => {
            alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù…Ø¹Ø±Ù!");
          });
        }
      }
    </script>
  </body>
</html>
