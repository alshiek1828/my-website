<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>موقع الشيخ</title>
  <style>
    body { margin:0; padding:0; font-family:'Segoe UI',sans-serif;
      background:linear-gradient(to bottom,#1c1c1c,#2b2b2b); color:#fff;
      display:flex; flex-direction:column; align-items:center;
    }
    header,main,footer { width:100%; max-width:800px; padding:20px; box-sizing:border-box; }
    header { text-align:center; padding-top:40px }
    header h1 { font-size:3em; color:#00ffe7; text-shadow:0 0 10px #00ffe7; margin:0 }
    .selectors, .controls, .rating { display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin:20px 0 }
    select, button, input[type="range"] {
      background:#333; color:#fff; border:none; border-radius:5px;
      padding:10px; font-size:1em; cursor:pointer;
    }
    select { min-width:200px }
    .error-message { color:#f66; text-align:center; margin:10px 0 }
    footer { text-align:center; font-size:.9em; color:#999; padding:20px 0 }
  </style>
</head>
<body>
  <header>
    <h1>بِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيمِ</h1>
    <p>موقع الشيخ</p>
  </header>
  <main>
    <div class="selectors">
      <label>اختر سورة:
        <select id="sura-select"><option value="" disabled selected>-- السورة --</option></select>
      </label>
      <label>اختر دولتك:
        <select id="country-select"><option value="" disabled selected>-- الدولة --</option></select>
      </label>
    </div>

    <div class="controls">
      <button onclick="seek(-10)">« 10 ث</button>
      <button id="playButton" onclick="toggleAudio()" disabled>▶</button>
      <button onclick="seek(10)">10 ث »</button>
    </div>
    <div class="error-message" id="audio-error"></div>

    <input type="range" id="progress" value="0" min="0" step="0.1">
    <audio id="myAudio" preload="metadata" crossorigin="anonymous"></audio>
  </main>
  <footer>&copy; 2025 – made by alshiek</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const suraSelect   = document.getElementById('sura-select');
  const countrySelect= document.getElementById('country-select');
  const audio        = document.getElementById('myAudio');
  const progress     = document.getElementById('progress');
  const playButton   = document.getElementById('playButton');
  const audioError   = document.getElementById('audio-error');

  // 1) قائمة السور الـ114
  const suras = [
    "الفاتحة","البقرة","آل عمران","النساء","المائدة","الأنعام","الأعراف","الأنفال",
    "التوبة","يونس","هود","يوسف","الرعد","إبراهيم","الحجر","النحل","الإسراء","الكهف",
    "مريم","طه","الأنبياء","الحج","المؤمنون","النور","الفرقان","الشعراء","النمل",
    "القصص","العنكبوت","الروم","لقمان","السجدة","الأحزاب","سبأ","فاطر","يس","الصافات",
    "ص","الزمر","غافر","فصلت","الشورى","الزخرف","الدخان","الجاثية","الأحقاف","محمد",
    "الفتح","الحجرات","ق","الذاريات","الطور","النجم","القمر","الرحمن","الواقعة","الحديد",
    "المجادلة","الحشر","الممتحنة","الصف","الجمعة","المنافقون","التغابن","الطلاق","التحريم",
    "الملك","القلم","الحاقة","المعارج","نوح","الجن","المزمل","المدثر","القيامة","الإنسان",
    "المرسلات","النبإ","النازعات","عبس","التكوير","الإنفطار","المطففين","الانشقاق","البروج",
    "الطارق","الأعلى","الغاشية","الفجر","البلد","الشمس","الليل","الضحى","الشرح","التين","العلق",
    "القدر","البينة","الزلزلة","العاديات","القارعة","التكاثر","العصر","الهمزة","الفيل","قريش",
    "الماعون","الكوثر","الكافرون","النصر","المسد","الإخلاص","الفلق","الناس"
  ];
  suras.forEach((name,i)=>{
    const o = document.createElement('option');
    o.value = i+1;
    o.textContent = `${i+1} - ${name}`;
    suraSelect.append(o);
  });

  // 2) قائمة الدول
  const countries = ['لبنان','مصر','السعودية','الأردن','الإمارات','الكويت','قطر','البحرين','عمان',
    'العراق','سوريا','فلسطين','الجزائر','المغرب','تونس','ليبيا','موريتانيا',
    'السودان','اليمن','الصومال','جيبوتي','جزر القمر'
  ];
  countries.forEach(c=>{
    const o = document.createElement('option');
    o.value=c; o.textContent=c;
    countrySelect.append(o);
  });

  // 3) حفظ/استرجاع الاختيارات
  if(localStorage.country) countrySelect.value=localStorage.country;
  countrySelect.addEventListener('change', ()=>{
    localStorage.country=countrySelect.value;
  });

  if(localStorage.sura) suraSelect.value=localStorage.sura;
  suraSelect.addEventListener('change', ()=>{
    localStorage.sura=suraSelect.value;
    playSura();
  });

  // 4) دالة pad لرقم السورة بثلاث خانات
  function pad(n){ return n.toString().padStart(3,'0'); }

  // 5) تشغيل السورة كاملة من Quranicaudio
  async function playSura(){
    audioError.textContent='';
    playButton.disabled=true;
    const num = pad(suraSelect.value);
    audio.src = `https://download.quranicaudio.com/quran/mishaari_raashid_al_3afaasee/64kbps/${num}.mp3`;
    audio.load();
    audio.onloadedmetadata = () => {
      progress.max = audio.duration;
      audio.play()
        .then(()=> playButton.textContent='❚❚')
        .catch(()=> audioError.textContent='تعذّر تشغيل الصوت');
      playButton.disabled=false;
    };
  }

  // 6) زر التشغيل/الإيقاف
  window.toggleAudio = ()=>{
    if(!audio.src) return playSura();
    if(audio.paused) audio.play().then(()=>playButton.textContent='❚❚');
    else { audio.pause(); playButton.textContent='▶'; }
  };

  // 7) شريط التقدم والتنقل
  audio.addEventListener('timeupdate', ()=> progress.value=audio.currentTime);
  progress.addEventListener('input', ()=> audio.currentTime=progress.value);
  audio.addEventListener('ended', ()=> playButton.textContent='▶');

  // 8) أزرار التقديم/التأخير
  window.seek = sec => {
    if(!audio.duration) return;
    audio.currentTime = Math.min(audio.duration,Math.max(0,audio.currentTime+sec));
  };
});
</script>
</body>
</html>
